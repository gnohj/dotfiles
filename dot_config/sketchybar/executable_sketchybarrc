#!/bin/bash
# Wrapper to ensure mise is activated before running lua

# Change to config directory first
cd "$HOME/.config/sketchybar" || exit 1

# Add Nix to PATH (mise is installed via Nix)
export PATH="/run/current-system/sw/bin:$PATH"

# Activate mise to get the correct lua in PATH
eval "$(mise activate bash)"

# Execute the lua script
exec lua - <<'LUA_SCRIPT'
-- Change to sketchybar config directory so modules can be found
local config_dir = os.getenv("HOME") .. "/.config/sketchybar"
package.path = package.path .. ";" .. config_dir .. "/?.lua"

require("init")
LUA_SCRIPT
