# Set tmux to use 256 colors and true color support
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

set -g status-style 'bg=default'

set -gq allow-passthrough on # Enables passthrough mode in Tmux 3.3+ for rendering images via nvim - image.nvim
set -g visual-activity off # Automatically show/hide images when switching tabs (windows) per session


set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

unbind %
bind | split-window -h 

unbind '"'
bind - split-window -v

unbind r
bind r source-file ~/.tmux.conf

bind j resize-pane -D 5
bind k resize-pane -U 5
bind l resize-pane -R 5
bind h resize-pane -L 5

bind -r m resize-pane -Z

set -g mouse on

set-window-option -g mode-keys vi

bind-key -T copy-mode-vi 'v' send -X begin-selection # start selecting text with "v"
bind-key -T copy-mode-vi 'y' send -X copy-selection # copy text with "y"
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"

unbind -T copy-mode-vi MouseDragEnd1Pane # don't exit copy mode when dragging with mouse

# remove delay for exiting insert mode with ESC in Neovim
set -sg escape-time 10

# move tmux bar to top instead of bottom
set -g status-position top

# renumber windows if you close one
set -g renumber-windows on

# prefix - I to update latest plugins from tpm
set -g @plugin 'tmux-plugins/tpm'

# list of tmux plugins
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect' # persist tmux sessions after computer restart
set -g @plugin 'tmux-plugins/tmux-continuum' # automatically saves sessions for you every 15 minutes

# Catppuccin theme
# https://github.com/catppuccin/tmux
# Cons:
# - Doesn't have a sync panes like dracula
#   - Actually I was able to implement this, see below
# Pros:
# - I feel my terminal waaaaay smoother/faster, not completely sure about this
#   But could be due to all the refreshing and polling of data Dracula had to do

# I pinned to 0.3.0 beacuse a new version had breaking changes and my tmux bar
# looked like crap, spent hours trying to figure it out
set -g @plugin 'catppuccin/tmux#v0.3.0'
# set -g @plugin 'catppuccin/tmux#latest'
# or frappe, macchiato, mocha
set -g @catppuccin_flavor 'mocha'

# I use this for my custom tmux banner on the right side
# tmux set -g @catppuccin_directory_color "#04d1f9"
# Color of the ACTIVE window, windows are opened with ctrl+b c
set -g @catppuccin_window_current_color "#04d1f9"
set -g @catppuccin_window_current_background "#0D1116"

# Color of the rest of the windows that are not active
set -g @catppuccin_window_default_color "#013e4a"
set -g @catppuccin_window_default_background "#0D1116"

# The following 2 colors are for the lines that separate tmux splits
set -g @catppuccin_pane_active_border_style "fg=#027d95"
set -g @catppuccin_pane_border_style "fg=#a5afc2"

# # This is the classic colored tmux bar that goes across the entire screen
set -g @catppuccin_status_background "theme"
set -g @catppuccin_status_background "#0D1116"
#
# # default for catppuccin_session_color is #{?client_prefix,$thm_red,$thm_green}
# # https://github.com/catppuccin/tmux/issues/140#issuecomment-1956204278
set -g @catppuccin_session_color "#{?client_prefix,#987afb,#37f499}"
#
# # This sets the color of the window text, #W shows the application name
#
set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_default_text "#[fg=#ebfafa]#W"
set -g @catppuccin_window_current_fill "number"
set -g @catppuccin_window_current_text "#[fg=#ebfafa]#W"
#
# # Put this option below the '@catppuccin_window_current_text' option for it to
# # override it, otherwise it won't work
# # I got the 'window_zoomed_flag' tip from 'DevOps Toolbox' youtuber
# # https://youtu.be/GH3kpsbbERo?si=4ZoV090qVbble7np
#
# # Second option shows a message when panes are syncronized
set -g @catppuccin_window_current_text "#W#{?window_zoomed_flag,#[fg=#585c89] (    ),}#{?pane_synchronized,#[fg=#585c89] SYNCHRONIZED-PANES,}"

set -g @catppuccin_window_left_separator ""
set -g @catppuccin_window_right_separator " "
set -g @catppuccin_window_middle_separator " █"
set -g @catppuccin_window_number_position "right"
set -g @catppuccin_status_modules_left "session"

# set -g @catppuccin_status_modules_right "none"
# set -g @catppuccin_status_modules_right "directory"
# set -g @catppuccin_directory_text " linkarzu   If you like the video like it  , and remember to subscribe   "
# set -g @catppuccin_directory_color "#04d1f9"
# set -g @catppuccin_directory_icon "null"

# As 'man tmux' specifies:
# Execute the first command if shell-command (run with /bin/sh) returns success or the second command otherwise
set -g @catppuccin_status_modules_right "null"

# `user` and `host` are kind of useless, dont change when you ssh to devices
# set -g @catppuccin_status_modules_right "directory user host"
set -g @catppuccin_status_left_separator " "
set -g @catppuccin_status_right_separator ""
set -g @catppuccin_status_right_separator_inverse "no"
set -g @catppuccin_status_connect_separator "no"

# set -g @catppuccin_directory_text "#{pane_current_path}"

# This can be set to "icon" or "all" if set to "all" the entire tmux session
# name has color
# set -g @catppuccin_status_fill "icon"
set -g @catppuccin_status_fill "all"
#
# If you set this to off, the tmux line completely dissappears
set -g @catppuccin_status_default "on"


# set -g @plugin 'fabioluciano/tmux-tokyo-night'
set -g @theme_transparent_status_bar 'true'
set -g @theme_transparent_left_separator_inverse ''
set -g @theme_transparent_right_separator_inverse ''
set -g @theme_left_separator ''
set -g @theme_right_separator ''
set -g @theme_plugins 'datetime,weather,battery'

set -g @resurrect-capture-pane-contents 'on'
set -g @continuum-restore 'on'


# Zero-out escape time delay for quicker response
set -s escape-time 0

# Active pane style - active is white   
# (actually default color of terminal theme, it seems).    
# Inactive panes are light gray.    
set -g window-active-style bg=#011423 # from wezterm.config.colors.background
# set -g window-style bg=#01101d
set -g window-style bg=default

# Open panes in cwd
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
